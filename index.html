<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Expense Tracker Pro</title>


  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
 
    *{
      margin:0;
      padding:0;
      box-sizing:border-box;
      font-family: "Inter", system-ui, sans-serif;
    }

    body{
      background: radial-gradient(circle at top,#1b1f2a,#0b0e14);
      color:#e5e7eb;
      min-height:100vh;
      padding:30px;
    }

    .app{
      max-width:1000px;
      margin:auto;
      background:linear-gradient(145deg,#111827,#0b1220);
      border-radius:22px;
      padding:30px;
      box-shadow:0 40px 120px rgba(0,0,0,.8);
    }

    h1{
      text-align:center;
      margin-bottom:25px;
      letter-spacing:1px;
    }

    .top-bar{
      display:flex;
      justify-content:flex-end;
      margin-bottom:15px;
    }
    .log{
       display: flex;
    justify-content: center;
    text-align: center;
    }

    select, input{
      background:#0f1420;
      color:#fff;
      border:1px solid #22283a;
      padding:14px;
      border-radius:12px;
      font-size:14px;
    }

    select:focus,input:focus{
      outline:none;
      border-color:#6366f1;
      box-shadow:0 0 0 3px rgba(99,102,241,.25);
    }

    .form{
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:15px;
      margin-bottom:20px;
    }

    button{
      border:none;
      border-radius:12px;
      padding:14px;
      font-weight:600;
      cursor:pointer;
      transition:.3s;
      color:#fff;
      background:linear-gradient(135deg,#6366f1,#4f46e5);
    }

    button:hover{
      transform:translateY(-2px);
      box-shadow:0 12px 35px rgba(99,102,241,.4);
    }

    #cancelBtn{
      background:#1f2937;
      display:none;
    }

    #total{
      text-align:right;
      margin:15px 0;
      font-size:18px;
      color:#a5b4fc;
    }

    .expense-card{
      background:linear-gradient(145deg,#0f172a,#020617);
      border:1px solid #1f2937;
      border-radius:18px;
      padding:20px;
      margin-bottom:15px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      transition:.3s;
    }

    .expense-card.active{
      border-color:#6366f1;
      box-shadow:0 0 40px rgba(99,102,241,.35);
    }

    .expense-card h4{
      font-size:22px;
    }

    .expense-card p{
      opacity:.8;
      margin:6px 0;
    }

    .expense-card span{
      font-size:12px;
      opacity:.6;
    }

    .actions button{
      padding:10px 14px;
      font-size:13px;
      margin-left:8px;
    }

    .actions .danger{
      background:linear-gradient(135deg,#ef4444,#b91c1c);
    }

    canvas{
      margin-top:25px;
    }

    @media(max-width:768px){
      .form{ grid-template-columns:1fr; }
      .expense-card{
        flex-direction:column;
        align-items:flex-start;
      }
      .actions{ margin-top:12px; }
    }
    

  </style>
</head>

<body>
<button class="log" onclick="logout()">Logout</button>

  <div class="app">
    <h1>Expense Tracker Pro</h1>

    <div class="top-bar">
      <select id="currency">
        <option value="PKR">PKR</option>
        <option value="USD">USD</option>
        <option value="AED">AED</option>
      </select>
    </div>


    <div class="form">
      <input type="number" id="input" placeholder="Amount" />
      <select id="select"></select>
      <input type="text" id="remarks" placeholder="Remarks" />
      <button id="expensebtn">Add Expense</button>
      <button id="cancelBtn">Cancel Edit</button>
    </div>

    <div id="total"></div>
    <div id="card"></div>

    <canvas id="expenseChart"></canvas>
  </div>
  

  <script>
     if(!localStorage.getItem("isLoggedIn")){
  window.location.href = "login.html";
     }

    const amount = document.querySelector("#input");
    const category = document.querySelector("#select");
    const remarks = document.querySelector("#remarks");
    const card = document.querySelector("#card");
    const expensebtn = document.querySelector("#expensebtn");
    const cancelBtn = document.querySelector("#cancelBtn");
    const totalBox = document.querySelector("#total");
    const currencySelect = document.querySelector("#currency");

    let allexpenses = JSON.parse(localStorage.getItem("expenses")) || [];
    let editIndex = null;
    let currentCurrency = "PKR";
    let chart;

    const rates = { PKR:1, USD:0.0036, AED:0.013 };

    const expenseCategories = [
      "Food","Petrol","Shopping","Haircut",
      "Other Expenses","Loan","Health","Travel"
    ];

    expenseCategories.forEach(c=>{
      category.innerHTML += `<option value="${c}">${c}</option>`;
    });

    function getDate(){
      const d = new Date();
      return `${d.getDate()}-${d.getMonth()+1}-${d.getFullYear()}`;
    }

    function save(){
      localStorage.setItem("expenses",JSON.stringify(allexpenses));
    }

    function formatAmount(val){
      return (val * rates[currentCurrency]).toFixed(2)+" "+currentCurrency;
    }

    function calculateTotal(){
      const total = allexpenses.reduce((s,i)=>s+Number(i.amount),0);
      totalBox.innerText = "Total Expense: " + formatAmount(total);
    }

    function renderChart(){
      const data = {};
      allexpenses.forEach(e=>{
        data[e.category]=(data[e.category]||0)+Number(e.amount);
      });

      if(chart) chart.destroy();

      chart = new Chart(document.getElementById("expenseChart"),{
        type:"doughnut",
        data:{
          labels:Object.keys(data),
          datasets:[{
            data:Object.values(data),
            backgroundColor:[
              "#6366f1","#22c55e","#f97316",
              "#ef4444","#14b8a6","#eab308"
            ]
          }]
        },
        options:{
          plugins:{ legend:{ labels:{ color:"#e5e7eb" } } }
        }
      });
    }

    function renderexpenses(){
      card.innerHTML="";
      allexpenses.forEach((item,index)=>{
        card.innerHTML+=`
        <div class="expense-card ${editIndex===index?"active":""}">
          <div>
            <h4>${formatAmount(item.amount)}</h4>
            <p>${item.remarks}</p>
            <span>${item.category} â€¢ ${item.date}</span>
          </div>
          <div class="actions">
            <button onclick="startEdit(${index})">Edit</button>
            <button class="danger" onclick="deleteExpense(${index})">Delete</button>
          </div>
        </div>`;
      });
      calculateTotal();
      renderChart();
    }

    expensebtn.addEventListener("click",()=>{
      if(!amount.value || !remarks.value) return;

      if(editIndex===null){
        allexpenses.push({
          amount:amount.value,
          category:category.value,
          remarks:remarks.value,
          date:getDate()
        });
      }else{
        allexpenses[editIndex].amount=amount.value;
        allexpenses[editIndex].category=category.value;
        allexpenses[editIndex].remarks=remarks.value;
        editIndex=null;
        expensebtn.innerText="Add Expense";
        cancelBtn.style.display="none";
      }

      amount.value="";
      remarks.value="";
      save();
      renderexpenses();
    });

    function deleteExpense(i){
      allexpenses.splice(i,1);
      save();
      renderexpenses();
    }

    function startEdit(i){
      editIndex=i;
      amount.value=allexpenses[i].amount;
      category.value=allexpenses[i].category;
      remarks.value=allexpenses[i].remarks;
      expensebtn.innerText="Update Expense";
      cancelBtn.style.display="inline-block";
      renderexpenses();
    }

    cancelBtn.addEventListener("click",()=>{
      editIndex=null;
      amount.value="";
      remarks.value="";
      expensebtn.innerText="Add Expense";
      cancelBtn.style.display="none";
      renderexpenses();
    });

    currencySelect.addEventListener("change",e=>{
      currentCurrency=e.target.value;
      renderexpenses();
    });

    renderexpenses();
    function logout(){
  localStorage.removeItem("isLoggedIn");
  window.location.href = "login.html";
}


  </script>
</body>
</html>
